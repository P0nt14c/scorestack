<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Adding Teams - Scorestack Documentation</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="../favicon.svg">
        
        
        <link rel="shortcut icon" href="../favicon.png">
        
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        
        <link rel="stylesheet" href="../css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="../fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../introduction.html">Introduction</a></li><li class="chapter-item expanded "><a href="../checks.html"><strong aria-hidden="true">1.</strong> Checks</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../checks/adding_checks.html"><strong aria-hidden="true">1.1.</strong> Adding Checks</a></li><li class="chapter-item expanded "><a href="../checks/check_json.html"><strong aria-hidden="true">1.2.</strong> check.json</a></li><li class="chapter-item expanded "><a href="../checks/attributes.html"><strong aria-hidden="true">1.3.</strong> Attributes</a></li><li class="chapter-item expanded "><a href="../checks/adding_teams.html" class="active"><strong aria-hidden="true">1.4.</strong> Adding Teams</a></li><li class="chapter-item expanded "><a href="../checks/updating.html"><strong aria-hidden="true">1.5.</strong> Updating Checks</a></li></ol></li><li class="chapter-item expanded "><a href="../reference.html"><strong aria-hidden="true">2.</strong> Check Reference</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../reference/dns.html"><strong aria-hidden="true">2.1.</strong> DNS</a></li><li class="chapter-item expanded "><a href="../reference/ftp.html"><strong aria-hidden="true">2.2.</strong> FTP</a></li><li class="chapter-item expanded "><a href="../reference/http.html"><strong aria-hidden="true">2.3.</strong> HTTP</a></li><li class="chapter-item expanded "><a href="../reference/icmp.html"><strong aria-hidden="true">2.4.</strong> ICMP</a></li><li class="chapter-item expanded "><a href="../reference/imap.html"><strong aria-hidden="true">2.5.</strong> IMAP</a></li><li class="chapter-item expanded "><a href="../reference/ldap.html"><strong aria-hidden="true">2.6.</strong> LDAP</a></li><li class="chapter-item expanded "><a href="../reference/mysql.html"><strong aria-hidden="true">2.7.</strong> MySQL</a></li><li class="chapter-item expanded "><a href="../reference/noop.html"><strong aria-hidden="true">2.8.</strong> Noop</a></li><li class="chapter-item expanded "><a href="../reference/smb.html"><strong aria-hidden="true">2.9.</strong> SMB</a></li><li class="chapter-item expanded "><a href="../reference/smtp.html"><strong aria-hidden="true">2.10.</strong> SMTP</a></li><li class="chapter-item expanded "><a href="../reference/ssh.html"><strong aria-hidden="true">2.11.</strong> SSH</a></li><li class="chapter-item expanded "><a href="../reference/vnc.html"><strong aria-hidden="true">2.12.</strong> VNC</a></li><li class="chapter-item expanded "><a href="../reference/winrm.html"><strong aria-hidden="true">2.13.</strong> WinRM</a></li><li class="chapter-item expanded "><a href="../reference/xmpp.html"><strong aria-hidden="true">2.14.</strong> XMPP</a></li></ol></li><li class="chapter-item expanded "><a href="../deployment.html"><strong aria-hidden="true">3.</strong> Deployment</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../deployment/binaries.html"><strong aria-hidden="true">3.1.</strong> Obtaining Binaries</a></li><li class="chapter-item expanded "><a href="../deployment/cloning.html"><strong aria-hidden="true">3.2.</strong> Cloning the Repository</a></li><li class="chapter-item expanded "><a href="../deployment/small.html"><strong aria-hidden="true">3.3.</strong> Small Architecture</a></li><li class="chapter-item expanded "><a href="../deployment/medium.html"><strong aria-hidden="true">3.4.</strong> Medium Architecture</a></li><li class="chapter-item expanded "><a href="../deployment/dynamicbeat.html"><strong aria-hidden="true">3.5.</strong> Dynamicbeat</a></li></ol></li><li class="chapter-item expanded "><a href="../design.html"><strong aria-hidden="true">4.</strong> Design</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../design/architecture.html"><strong aria-hidden="true">4.1.</strong> Elastic Stack Architecture</a></li><li class="chapter-item expanded "><a href="../design/permissions.html"><strong aria-hidden="true">4.2.</strong> User Roles</a></li><li class="chapter-item expanded "><a href="../design/check.html"><strong aria-hidden="true">4.3.</strong> Life of a Check</a></li></ol></li><li class="chapter-item expanded "><a href="../building.html"><strong aria-hidden="true">5.</strong> Building Binaries</a></li><li class="chapter-item expanded "><a href="../appendix/faq.html"><strong aria-hidden="true">6.</strong> Appendix A - FAQ</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">7.</strong> Appendix B - Glossary</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">8.</strong> Appendix C - Developer Processes</div></li><li class="spacer"></li><li class="chapter-item expanded affix "><a href="../contributors.html">Contributors</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">Scorestack Documentation</h1>

                    <div class="right-buttons">
                        
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#adding-teams" id="adding-teams">Adding Teams</a></h1>
<p>Once you've written your <a href="./check_json.html">check definitions</a> and <a href="./attributes.html">defined their attributes</a>, you need to add the checks to Scorestack so they can start running. We have written an <code>add-team.sh</code> script that will parse the check folder and file structure and add the checks to Scorestack one team at a time.</p>
<blockquote>
<p>Please note that the <code>add-team.sh</code> script assumes that all checks will be run by all of the teams. If you have some checks that will only be run by specific teams, you will have to add them manually. If this is a use case that you'd like to see implemented, <a href="https://github.com/scorestack/scorestack/issues/new/choose">open an issue</a> and we'd be happy to take a look.</p>
</blockquote>
<p>The <code>add-team.sh</code> script performs the following actions:</p>
<ol>
<li>Add the all-team scoreboard if it does not already exist</li>
<li>Configure the default index template for Scorestack indices</li>
<li>For each team name passed as an argument:
<ol>
<li>Add the checks for the team</li>
<li>Add a role for the team</li>
<li>Add the team user</li>
<li>Add the team's dashboard</li>
</ol>
</li>
</ol>
<p>These actions can all be performed manually by interacting with the Elasticsearch API, but the <code>add-team.sh</code> script abstracts over those operations for you.</p>
<blockquote>
<p>Please note the <code>add-team.sh</code> script depends on the <a href="https://stedolan.github.io/jq/"><code>jq</code></a> tool. If this tool is not available on your system or you cannot install it, consider running the script within a docker container.</p>
</blockquote>
<p>Before running the script, you will need to configure some values. Open the script in a text editor and modify the following values at the top of the file:</p>
<pre><code>ELASTICSEARCH_HOST=localhost:9200
KIBANA_HOST=localhost:5601
CHECK_FOLDER=examples
USERNAME=root
PASSWORD=changeme
</code></pre>
<ul>
<li><code>ELASTICSEARCH_HOST</code>: The address and port of the Elasticsearch server.</li>
<li><code>KIBANA_HOST</code>: The address and port of the Kibana server.</li>
<li><code>CHECK_FOLDER</code>: The top level folder containing all checks.</li>
<li><code>USERNAME</code>: The username of the Scorestack admin user. This should usually be left as <code>root</code>, unless you have added another user to the Elastic cluster with the <code>superuser</code> role.</li>
<li><code>PASSWORD</code>: The password for the user referenced in <code>USERNAME</code>.</li>
</ul>
<p>Once these values are correct for your environment, you can run <code>add-team.sh</code>. Each argument after the script name is the name of a team you would like to add.</p>
<pre><code class="language-shell">./add-team.sh team01 team02 team03
</code></pre>
<p>In this case, three teams will be added: <code>team01</code>, <code>team02</code>, and <code>team03</code>.</p>
<h2><a class="header" href="#adding-multiple-teams" id="adding-multiple-teams">Adding Multiple Teams</a></h2>
<p>Thanks to some additional templating configured in the <code>add-team.sh</code> script, each check only has to be written once for multiple teams.</p>
<p>When adding checks for a team, the script will make the following modifications to a definition or attribute file:</p>
<ul>
<li>Append <code>-GROUP</code> to the <code>id</code> parameter, where <code>GROUP</code> is the name of the group</li>
<li>Replace <code>${TEAM}</code> wherever it occurs with the name of the group</li>
<li>Replace <code>${TEAM_NUM}</code> wherever it occurs with the group's number</li>
</ul>
<h3><a class="header" href="#team_num" id="team_num"><code>${TEAM_NUM}</code></a></h3>
<p>When a team name is passed to the <code>add-team.sh</code> script, any numbers found at the end of the team name will be parsed as the team's number. For example, <code>team10</code> would have a team number of <code>10</code>.</p>
<p>Also, any leading zeros in the team number will be removed. For example, <code>team04</code> would have a team number of <code>4</code>, <strong>not</strong> <code>04</code>.</p>
<p>This can be useful for templating the team's number into a domain or IP address to customize the target of a check for each team.</p>
<h3><a class="header" href="#example" id="example">Example</a></h3>
<p>Let's go through an example of adding multiple teams to Scorestack to see how we can use the features of the <code>add-team.sh</code> script to our advantage.</p>
<p>We want to add 5 teams to Scorestack for a competition. Let's use an example DNS check definition with some associated administrator attributes.</p>
<p><code>check.json</code></p>
<pre><code class="language-json">{
    &quot;id&quot;: &quot;dns&quot;,
    &quot;name&quot;: &quot;DNS&quot;,
    &quot;type&quot;: &quot;dns&quot;,
    &quot;group&quot;: &quot;example&quot;,
    &quot;score_weight&quot;: 1,
    &quot;definition&quot;: {
        &quot;Server&quot;: &quot;{{.Server}}&quot;,
        &quot;Port&quot;: &quot;{{.Port}}&quot;,
        &quot;Fqdn&quot;: &quot;{{.Fqdn}}&quot;,
        &quot;ExpectedIP&quot;: &quot;{{.ExpectedIP}}&quot;
    }
}
</code></pre>
<p><code>admin-attribs.json</code></p>
<pre><code class="language-json">{
    &quot;Server&quot;: &quot;192.168.1.10&quot;,
    &quot;Port&quot;: &quot;53&quot;,
    &quot;Fqdn&quot;: &quot;www.team01.com&quot;,
    &quot;ExpectedIP&quot;: &quot;192.168.1.98&quot;
}
</code></pre>
<p>This DNS check will query the DNS server at <code>192.168.1.10</code> for the host <code>host1.com</code>, and will expect the response to report the host's IP as <code>192.168.1.98</code>. We can use the <code>${TEAM}</code> and <code>${TEAM_NUM}</code> templates to make this check a bit more generic so it'll work for all of the teams! The following is how we would do the templating:</p>
<p><code>check.json</code> with Team templates</p>
<pre><code class="language-json">{
    &quot;id&quot;: &quot;dns&quot;,
    &quot;name&quot;: &quot;DNS&quot;,
    &quot;type&quot;: &quot;dns&quot;,
    &quot;group&quot;: &quot;${TEAM}&quot;,
    &quot;score_weight&quot;: 1,
    &quot;definition&quot;: {
        &quot;Server&quot;: &quot;{{.Server}}&quot;,
        &quot;Port&quot;: &quot;{{.Port}}&quot;,
        &quot;Fqdn&quot;: &quot;{{.Fqdn}}&quot;,
        &quot;ExpectedIP&quot;: &quot;{{.ExpectedIP}}&quot;
    }
}
</code></pre>
<p><code>admin-attribs.json</code> with Team templates</p>
<pre><code class="language-json">{
    &quot;Server&quot;: &quot;192.168.${TEAM_NUM}.10&quot;,
    &quot;Port&quot;: &quot;53&quot;,
    &quot;Fqdn&quot;: &quot;www.${TEAM}.com&quot;,
    &quot;ExpectedIP&quot;: &quot;192.168.${TEAM_NUM}.98&quot;
}
</code></pre>
<p>Finally, let's see what the checks will look like once the script performs the initial templating and modifications. In this example, we'll assume the script was run with one argument - <code>team05</code>.</p>
<p><code>check.json</code> modified for <code>team05</code></p>
<pre><code class="language-json">{
    &quot;id&quot;: &quot;dns-team05&quot;,
    &quot;name&quot;: &quot;DNS&quot;,
    &quot;type&quot;: &quot;dns&quot;,
    &quot;group&quot;: &quot;team05&quot;,
    &quot;score_weight&quot;: 1,
    &quot;definition&quot;: {
        &quot;Server&quot;: &quot;{{.Server}}&quot;,
        &quot;Port&quot;: &quot;{{.Port}}&quot;,
        &quot;Fqdn&quot;: &quot;{{.Fqdn}}&quot;,
        &quot;ExpectedIP&quot;: &quot;{{.ExpectedIP}}&quot;
    }
}
</code></pre>
<p><code>admin-attribs.json</code> modified for <code>team05</code></p>
<pre><code class="language-json">{
    &quot;Server&quot;: &quot;192.168.5.10&quot;,
    &quot;Port&quot;: &quot;53&quot;,
    &quot;Fqdn&quot;: &quot;www.team05.com&quot;,
    &quot;ExpectedIP&quot;: &quot;192.168.5.98&quot;
}
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../checks/attributes.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../checks/updating.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../checks/attributes.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="../checks/updating.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
